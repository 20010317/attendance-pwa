<details>
<summary>▶ index.html（タップで開く）</summary>

  <!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>勤怠管理システム</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f4c81">
<style>
body{margin:0;font-family:-apple-system,system-ui;background:#f2f4f7}
header{background:#0f4c81;color:#fff;padding:16px}
main{padding:16px}
.card{background:#fff;padding:16px;border-radius:8px;margin-bottom:16px}
button{width:100%;padding:14px;margin:6px 0;font-size:16px;border:none;border-radius:6px;background:#1976d2;color:#fff}
.sub{background:#607d8b}
</style>
</head>
<body>
<header>
<strong>アビームコンサルティング株式会社</strong><br>
<small>勤怠管理システム</small>
</header>
<main>
<div class="card">
<button onclick="send('出勤')">出勤</button>
<button onclick="send('退勤')">退勤</button>
<button class="sub" onclick="send('外出')">外出</button>
<button class="sub" onclick="send('戻り')">戻り</button>
</div>
<div class="card">
ステータス：<span id="status">未送信</span>
</div>
  <div class="card">
<strong>本日の打刻</strong>
<ul id="log"></ul>
</div>
</main>


<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycbw47scpEF4AJuQFu7SuCoVRk3zzgWTcgsrvD9PtlKJv0WgUy42HYdlTsgVlhuJkRuYK5A/exec";
let lastStatus = "未出勤";

/* 起動時に最後の打刻状態を取得 */
window.onload = () => {
  fetch(ENDPOINT)
    .then(r => r.json())
    .then(data => {
      lastStatus = data.last;
      document.getElementById("status").innerText =
        "前回：" + lastStatus;
    })
    .catch(() => {
      document.getElementById("status").innerText =
        "状態取得失敗";
    });
};

/* 打刻処理 */
function send(t){
  if (!canStamp(t)) {
    alert("その打刻はできません");
    return;
  }

  fetch(ENDPOINT, {
    method: "POST",
    body: JSON.stringify({ type: t })
  })
  .then(() => {
    lastStatus = t;
    updateStatus(t);
  })
  .catch(() => {
    alert("通信エラー");
  });
}

/* 二重打刻判定 */
function canStamp(t){
  if (lastStatus === "未出勤" && t === "出勤") return true;
  if (lastStatus === "出勤" && t === "退勤") return true;
  return false;
}

/* 画面更新 */
function updateStatus(t){
  document.getElementById("status").innerText =
    new Date().toLocaleTimeString() + " " + t;
}

/* PWA */
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>
</body>
</html>

</details>
