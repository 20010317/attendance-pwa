<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‹¤æ€ ç®¡ç†ã‚¢ãƒ—ãƒª</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/charts/loader.js"></script>
<style>
/* å…¨ä½“ */
body {
  font-family: 'Roboto', sans-serif;
  background: #F5F6FA; /* æ˜ã‚‹ã„ã‚°ãƒ¬ãƒ¼ç³» */
  margin:0; padding:0 0 60px 0;
}

/* ãƒ˜ãƒƒãƒ€ãƒ¼ */
.header-card {
  background:#3A6EA5;
  color:white; border-radius:10px; padding:15px 20px;
  margin:15px; text-align:center;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}
.header-card h1 {margin:0; font-size:20px; font-weight:700;}
.header-card p {margin:5px 0 0 0; font-size:14px; font-weight:500;}

/* ãƒœã‚¿ãƒ³ã‚°ãƒªãƒƒãƒ‰ */
.button-grid {
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:15px;
  margin:0 15px 20px 15px;
}
button {
  font-size:16px; font-weight:500; padding:18px; border:none;
  border-radius:50px; color:white; cursor:pointer;
  transition: 0.15s; box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
button:active { transform:scale(0.95); filter: brightness(1.1);}
.green {background:#2C82C9;}
.red   {background:#E74C3C;}
.orange{background:#F39C12;}
.blue  {background:#3498DB;}

/* æ™‚è¨ˆã‚«ãƒ¼ãƒ‰ */
#clockCard {
  background:#1C1C1C;
  border-radius:10px; margin:0 15px 15px 15px;
  padding:12px 0; text-align:center; color:#66FF66;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
  overflow:hidden;
}
#dateDisplay { font-size:16px; margin-bottom:4px; }
#digitalClock { font-family:'Orbitron','Courier New',monospace; font-size:44px; letter-spacing:2px; margin:0; }

/* ã‚«ãƒ¼ãƒ‰ */
.card {
  background:white; border-radius:10px; padding:15px; margin:10px 15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08); opacity:0; transform:translateY(10px);
  transition: all 0.5s ease;
}
.card.visible {opacity:1; transform:translateY(0);}
.card h3 {margin-top:0; font-size:16px; font-weight:500; color:#34495E;}
.card p {margin:6px 0; font-size:14px; line-height:1.4; color:#2C3E50; white-space:pre-line;}

/* ã‚°ãƒ©ãƒ• */
#chart_div { width:100%; height:250px; }

/* ãƒˆãƒ¼ã‚¹ãƒˆ */
#toast {
  position:fixed; bottom:70px; left:50%; transform:translateX(-50%);
  background: rgba(0,0,0,0.7); color:white; padding:10px 25px; border-radius:25px;
  opacity:0; transition:0.4s; font-weight:500; z-index:1000;
}

/* ä¸‹éƒ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ */
.footer-bar {
  position:fixed; bottom:0; left:0; width:100%;
  background:#34495E; color:#ECF0F1; font-size:14px; font-weight:500;
  text-align:center; padding:10px 0; box-shadow:0 -3px 6px rgba(0,0,0,0.1);
}
</style>
</head>
<body>

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="header-card">
  <h1>æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«</h1>
  <p>å±±ç”° å¤ªéƒ / ç¤¾å“¡ç•ªå·: 12345</p>
</div>

<!-- æ‰“åˆ»ãƒœã‚¿ãƒ³ -->
<div class="button-grid">
  <button class="green" onclick="post('å‡ºå‹¤')">ğŸŸ¢ å‡ºå‹¤</button>
  <button class="red" onclick="post('é€€å‹¤')">ğŸ”´ é€€å‹¤</button>
  <button class="orange" onclick="post('å¤–å‡º')">ğŸŸ  å¤–å‡º</button>
  <button class="blue" onclick="post('æˆ»ã‚Š')">ğŸ”µ æˆ»ã‚Š</button>
</div>

<!-- æ™‚è¨ˆã‚«ãƒ¼ãƒ‰ -->
<div id="clockCard">
  <div id="dateDisplay">----/--/-- (---)</div>
  <div id="digitalClock">--:--:--</div>
</div>

<!-- ä»Šæ—¥ã®å‹¤å‹™çŠ¶æ³ -->
<div class="card status" id="todayCard">
  <h3>ä»Šæ—¥ã®å‹¤å‹™çŠ¶æ³</h3>
  <p id="todayStatus">èª­ã¿è¾¼ã¿ä¸­...</p>
</div>

<!-- æœˆæ¬¡ã‚µãƒãƒªãƒ¼ -->
<div class="card status" id="monthCard">
  <h3>æœˆæ¬¡ã‚µãƒãƒªãƒ¼</h3>
  <p id="monthSummary">èª­ã¿è¾¼ã¿ä¸­...</p>
</div>

<!-- ã‚°ãƒ©ãƒ•ã‚«ãƒ¼ãƒ‰ -->
<div class="card" id="chartCard">
  <div id="chart_div"></div>
</div>

<div id="toast"></div>

<div class="footer-bar" id="footerStatus">
  å‹¤å‹™ 0h | æ®‹æ¥­ 0h | å¤–å‡º 0h
</div>

<script>
const WEBAPP_URL = 'ã€ã“ã“ã«Webã‚¢ãƒ—ãƒªURLã€‘';

// ãƒˆãƒ¼ã‚¹ãƒˆ
function showToast(msg){
  const toast = document.getElementById('toast');
  toast.innerText = msg; toast.style.opacity = 1;
  setTimeout(()=>{ toast.style.opacity=0; }, 1500);
}

// æ‰“åˆ»ãƒœã‚¿ãƒ³
function post(type){
  fetch(WEBAPP_URL, { method:'POST', body: JSON.stringify({type:type}) })
  .then(r=>r.json()).then(d=>{
    showToast(d.status+(d.message?': '+d.message:''));
    loadStatus();
  }).catch(()=>showToast('é€šä¿¡ã‚¨ãƒ©ãƒ¼'));
}

// å‹¤å‹™çŠ¶æ³èª­ã¿è¾¼ã¿
function loadStatus(){
  fetch(WEBAPP_URL+'?type=status')
  .then(r=>r.json()).then(d=>{
    document.getElementById('todayStatus').innerText =
      `å‡ºå‹¤: ${d.checkIn}\né€€å‹¤: ${d.checkOut}\nå®ŸåŠ´åƒ: ${d.work}\næ®‹æ¥­: ${d.overtime}\nå¤–å‡º: ${d.break}\næ·±å¤œ: ${d.midnight}`;
    document.getElementById('todayCard').classList.add('visible');

    document.getElementById('monthSummary').innerText =
      `å‡ºå‹¤æ—¥æ•°: ${d.days}\nåŠ´åƒåˆè¨ˆ: ${d.totalWork}\næ®‹æ¥­åˆè¨ˆ: ${d.totalOvertime}\næ·±å¤œåˆè¨ˆ: ${d.totalMidnight}\nå¤–å‡ºåˆè¨ˆ: ${d.totalBreak}`;
    document.getElementById('monthCard').classList.add('visible');

    drawChart(d);

    document.getElementById('footerStatus').innerText =
      `å‹¤å‹™ ${d.work || 0}h | æ®‹æ¥­ ${d.overtime || 0}h | å¤–å‡º ${d.break || 0}h`;
  });
}

// å¹´æœˆæ—¥ï¼‹æ›œæ—¥ï¼‹æ™‚è¨ˆ
function updateDateTime(){
  const now=new Date();
  const year=now.getFullYear();
  const month=(now.getMonth()+1).toString().padStart(2,'0');
  const day=now.getDate().toString().padStart(2,'0');
  const weekdays=['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
  const weekday=weekdays[now.getDay()];
  document.getElementById('dateDisplay').innerText=`${year}/${month}/${day} (${weekday})`;
  const timeString=now.getHours().toString().padStart(2,'0')+':'+
                   now.getMinutes().toString().padStart(2,'0')+':'+
                   now.getSeconds().toString().padStart(2,'0');
  document.getElementById('digitalClock').innerText=timeString;
}
setInterval(updateDateTime,1000);
updateDateTime();

// ã‚°ãƒ©ãƒ•
google.charts.load('current', {'packages':['corechart']});
function drawChart(d){
  const data=google.visualization.arrayToDataTable([
    ['é …ç›®','æ™‚é–“',{role:'style'}],
    ['åŠ´åƒ', d.work||0, 'color:#2C82C9'],
    ['æ®‹æ¥­', d.overtime||0, 'color:#E74C3C'],
    ['æ·±å¤œ', d.midnight||0, 'color:#9B59B6'],
    ['å¤–å‡º', d.break||0, 'color:#F39C12']
  ]);
  const options={title:'æœˆæ¬¡å‹¤æ€ ã‚°ãƒ©ãƒ•', legend:{position:'bottom'}, animation:{startup:true,duration:600,easing:'out'}};
  const chart=new google.visualization.ColumnChart(document.getElementById('chart_div'));
  chart.draw(data, options);
}
google.charts.setOnLoadCallback(loadStatus);
</script>
</body>
</html>